{"version":3,"file":"login-CltNNAN9.js","sources":["../../../../../../../manager-server-ui/src/services/user.ts","../../../../../../../manager-server-ui/src/login/login.vue","../../../../../../../manager-server-ui/src/login.ts"],"sourcesContent":["import axios from 'axios';\n\nclass User {\n  static login(username: string, password: string) {\n    return axios.post(\n      'api/login',\n      { username, password },\n      { headers: { 'Content-Type': 'application/json' } },\n    );\n  }\n}\n\nexport default User;\n","<template>\n  <form class=\"w-5/6 md:1/2 max-w-lg\">\n    <sm-panel>\n      <input\n        v-if=\"csrf\"\n        :name=\"csrf.parameterName\"\n        :value=\"csrf.token\"\n        type=\"hidden\"\n      />\n      <div class=\"flex text-lg pb-3 items-center\">\n        <img v-if=\"icon\" :src=\"icon\" class=\"w-8 h-8 mr-2\" />\n        <h1 class=\"title has-text-primary\" v-text=\"title\" />\n      </div>\n      <div class=\"relative border-t -ml-4 -mr-4 overflow-hidden\">\n        <sm-wave class=\"bg-wave--login\" />\n        <div class=\"ml-4 mr-4 pt-2 z-10 relative\">\n          <sm-alert :error=\"message\" />\n          <sm-alert :error=\"logout\" :severity=\"Severity.INFO\" />\n          <div :class=\"{ 'has-errors': error }\" class=\"pb-4 form-group\">\n            <sm-input\n              v-model=\"username\"\n              :label=\"t('login.placeholder.username')\"\n              autocomplete=\"username\"\n              name=\"username\"\n              type=\"text\"\n              autofocus\n            />\n            <sm-input\n              v-model=\"password\"\n              :label=\"t('login.placeholder.password')\"\n              autocomplete=\"current-password\"\n              name=\"password\"\n              type=\"password\"\n            />\n            <sm-checkbox\n              v-if=\"rememberMeEnabled\"\n              :label=\"t('login.remember_me')\"\n              class=\"justify-end\"\n              name=\"remember-me\"\n            />\n          </div>\n        </div>\n      </div>\n\n      <template #footer>\n        <div class=\"text-right\">\n          <sm-button @click=\"login\"> 登录 </sm-button>\n        </div>\n      </template>\n    </sm-panel>\n  </form>\n</template>\n\n<script setup>\nimport { computed, ref } from 'vue';\nimport { useI18n } from 'vue-i18n';\n\nimport SmAlert, { Severity } from '@/components/sm-alert';\nimport SmButton from '@/components/sm-button';\nimport SmCheckbox from '@/components/sm-checkbox';\nimport SmInput from '@/components/sm-input';\nimport SmPanel from '@/components/sm-panel';\nimport SmWave from '@/components/sm-wave';\n\nimport { setCurrentUser } from '@/config';\nimport User from '@/services/user';\n\nconst i18n = useI18n();\nconst t = i18n.t;\n\nconst props = defineProps({\n  param: {\n    type: Object,\n    default: () => ({}),\n  },\n  icon: {\n    type: String,\n    default: undefined,\n  },\n  title: {\n    type: String,\n    required: true,\n  },\n  csrf: {\n    type: Object,\n    default: undefined,\n  },\n  theme: {\n    type: Object,\n    default: undefined,\n  },\n});\n\nconst { rememberMeEnabled } = window.uiSettings;\n\nconst username = ref('');\nconst password = ref('');\nconst message = ref(null);\n\nconst login = (event) => {\n  event.preventDefault();\n  User.login(username.value, password.value)\n    .then((response) => {\n      // 成功存储用户信息和设置请求头\n      localStorage.setItem('token', response.data);\n      setCurrentUser(username.value);\n      let url = window.location.href.replace('login.html', 'applications');\n      url = url.replace('login', 'applications');\n      window.location.href = url;\n    })\n    .catch((error) => {\n      // 失败提示\n      message.value = error.response.data;\n      localStorage.removeItem('token');\n      setTimeout(() => {\n        message.value = null;\n      }, 3000);\n    });\n};\n\nconst logout = computed(() => {\n  return props.param.logout !== undefined\n    ? t('login.logout_successful')\n    : undefined;\n});\n</script>\n\n<style scoped>\n.bg-wave--login {\n  @apply z-0 absolute left-0;\n  min-width: 100%;\n  height: 4rem;\n}\n\n.form-group {\n  @apply grid grid-cols-1 gap-2;\n}\n\n.form-group.has-errors label {\n  @apply text-red-500;\n}\n\n.form-group.has-errors input {\n  @apply focus:ring-red-500 focus:border-red-500 border-red-400;\n}\n</style>\n","import { createApp } from 'vue';\r\n\r\nimport './login.css';\r\n\r\nimport i18n from './i18n';\r\nimport Login from './login/login.vue';\r\n\r\nconst app = createApp(Login, {\r\n  csrf: window.csrf,\r\n  icon: window.uiSettings.icon,\r\n  title: window.uiSettings.title,\r\n  theme: window.uiSettings.theme,\r\n  param: window.param,\r\n});\r\napp.use(i18n);\r\napp.mount('#login');\r\n"],"names":["User","username","password","axios","t","useI18n","props","__props","rememberMeEnabled","ref","message","login","event","response","setCurrentUser","url","error","logout","computed","app","createApp","Login","i18n"],"mappings":"yOAEA,MAAMA,CAAK,CACT,OAAO,MAAMC,EAAkBC,EAAkB,CAC/C,OAAOC,EAAM,KACX,YACA,CAAE,SAAAF,EAAU,SAAAC,CAAS,EACrB,CAAE,QAAS,CAAE,eAAgB,mBAAqB,CAAA,CAEtD,CACF,4cC0DA,MAAME,EADOC,EAAO,EACL,EAETC,EAAQC,EAuBR,CAAE,kBAAAC,CAAiB,EAAK,OAAO,WAE/BP,EAAWQ,EAAI,EAAE,EACjBP,EAAWO,EAAI,EAAE,EACjBC,EAAUD,EAAI,IAAI,EAElBE,EAASC,GAAU,CACvBA,EAAM,eAAc,EACpBZ,EAAK,MAAMC,EAAS,MAAOC,EAAS,KAAK,EACtC,KAAMW,GAAa,CAElB,aAAa,QAAQ,QAASA,EAAS,IAAI,EAC3CC,EAAeb,EAAS,KAAK,EAC7B,IAAIc,EAAM,OAAO,SAAS,KAAK,QAAQ,aAAc,cAAc,EACnEA,EAAMA,EAAI,QAAQ,QAAS,cAAc,EACzC,OAAO,SAAS,KAAOA,CAC7B,CAAK,EACA,MAAOC,GAAU,CAEhBN,EAAQ,MAAQM,EAAM,SAAS,KAC/B,aAAa,WAAW,OAAO,EAC/B,WAAW,IAAM,CACfN,EAAQ,MAAQ,IACjB,EAAE,GAAI,CACb,CAAK,CACL,EAEMO,EAASC,EAAS,IACfZ,EAAM,MAAM,SAAW,OAC1BF,EAAE,yBAAyB,EAC3B,MACL,0uCCrHKe,EAAMC,EAAUC,EAAO,CAC3B,KAAM,OAAO,KACb,KAAM,OAAO,WAAW,KACxB,MAAO,OAAO,WAAW,MACzB,MAAO,OAAO,WAAW,MACzB,MAAO,OAAO,KAChB,CAAC,EACDF,EAAI,IAAIG,CAAI,EACZH,EAAI,MAAM,QAAQ"}